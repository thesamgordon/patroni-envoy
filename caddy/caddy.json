{
  "apps": {
    "layer4": {
      "servers": {
        "primary": {
          "listen": [":5000"],
          "routes": [
            {
              "handle": [
                {
                  "handler": "proxy",
                  "upstreams": [
                    {
                      "dial": ["{env.PATRONI1_IP}:5432"]
                    },
                    {
                      "dial": ["{env.PATRONI2_IP}:5432"]
                    },
                    {
                      "dial": ["{env.PATRONI3_IP}:5432"]
                    }
                  ],
                  "health_checks": {
                    "active": {
                      "interval": "5s",
                      "timeout": "2s",
                      "port": 8008,
                      "uri": "/primary"
                    }
                  }
                }
              ]
            }
          ]
        },
        "replica": {
          "listen": [":5001"],
          "routes": [
            {
              "handle": [
                {
                  "handler": "proxy",
                  "upstreams": [
                    {
                      "dial": ["{env.PATRONI1_IP}:5432"]
                    },
                    {
                      "dial": ["{env.PATRONI2_IP}:5432"]
                    },
                    {
                      "dial": ["{env.PATRONI3_IP}:5432"]
                    }
                  ],
                  "health_checks": {
                    "active": {
                      "interval": "5s",
                      "timeout": "2s",
                      "port": 8008,
                      "uri": "/replica"
                    }
                  }
                }
              ]
            }
          ]
        }
      }
    }
  }
}
